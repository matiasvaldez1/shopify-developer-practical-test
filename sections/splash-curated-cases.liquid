{{ 'splash-curated-cases.css' | asset_url | stylesheet_tag }}
{{ 'splash-wine-card.css' | asset_url | stylesheet_tag }}

<section class="splash-curated-cases">
  <div class="splash-curated-cases__container">
    <div class="splash-curated-cases__header">
      {% for block in section.blocks %}
        {% case block.type %}
          {% when 'section_title' %}
            <h2 class="splash-curated-cases__title" {{ block.shopify_attributes }}>
              {{ block.settings.title }}
            </h2>
        {% endcase %}
      {% endfor %}
    </div>

    {% assign tab_blocks = section.blocks | where: 'type', 'product_tab' %}
    {% if tab_blocks.size > 0 %}
      <div class="splash-curated-cases__nav">
        {% for tab_block in tab_blocks %}
          <button
            class="splash-curated-cases__nav-item{% if forloop.first %} active{% endif %}"
            onclick="switchTab(event, 'tab-{{ forloop.index }}')"
            {{ tab_block.shopify_attributes }}>
            {{ tab_block.settings.tab_name }}
          </button>
        {% endfor %}
      </div>

      {% for tab_block in tab_blocks %}
        <div
          id="tab-{{ forloop.index }}"
          class="splash-curated-cases__tab-content{% if forloop.first %} active{% endif %}"
          {{ tab_block.shopify_attributes }}>
          <div class="splash-curated-cases__grid">
            {% if tab_block.settings.show_wine_1 %}
              <div class="splash-wine-card">
                <div class="splash-wine-card__content">
                  <h3 class="splash-wine-card__name">{{ tab_block.settings.wine_1_name }}</h3>
                  <p class="splash-wine-card__vintage">{{ tab_block.settings.wine_1_vintage }}</p>
                  <div class="splash-wine-card__pricing">
                    <span class="splash-wine-card__price">${{ tab_block.settings.wine_1_price }}</span>
                  </div>
                  <button class="splash-wine-card__button">{{ tab_block.settings.wine_1_button_text | default: 'Add to Cart' }}</button>
                </div>
              </div>
            {% endif %}
            {% if tab_block.settings.show_wine_2 %}
              <div class="splash-wine-card">
                <div class="splash-wine-card__content">
                  <h3 class="splash-wine-card__name">{{ tab_block.settings.wine_2_name }}</h3>
                  <p class="splash-wine-card__vintage">{{ tab_block.settings.wine_2_vintage }}</p>
                  <div class="splash-wine-card__pricing">
                    <span class="splash-wine-card__price">${{ tab_block.settings.wine_2_price }}</span>
                  </div>
                  <button class="splash-wine-card__button">{{ tab_block.settings.wine_2_button_text | default: 'Add to Cart' }}</button>
                </div>
              </div>
            {% endif %}
          </div>
        </div>
      {% endfor %}
    {% endif %}

    {% for block in section.blocks %}
      {% case block.type %}
        {% when 'view_all_button' %}
          <div class="splash-curated-cases__view-all" {{ block.shopify_attributes }}>
            {% if block.settings.button_link != blank %}
              <a href="{{ block.settings.button_link }}" class="splash-curated-cases__view-all-btn">
                {{ block.settings.button_text }}
              </a>
            {% endif %}
          </div>
      {% endcase %}
    {% endfor %}
  </div>
</section>

<script>
function switchTab(evt, tabName) {
  var i, tabcontent, tablinks;

  // Hide all tab content
  tabcontent = document.getElementsByClassName("splash-curated-cases__tab-content");
  for (i = 0; i < tabcontent.length; i++) {
    tabcontent[i].classList.remove("active");
  }

  // Remove active class from all tabs
  tablinks = document.getElementsByClassName("splash-curated-cases__nav-item");
  for (i = 0; i < tablinks.length; i++) {
    tablinks[i].classList.remove("active");
  }

  // Show the specific tab and mark button as active
  document.getElementById(tabName).classList.add("active");
  evt.currentTarget.classList.add("active");
}
</script>

{% schema %}
{
  "name": "Curated Cases",
  "tag": "section",
  "class": "section",
  "settings": [],
  "blocks": [
    {
      "type": "section_title",
      "name": "Section Title",
      "limit": 1,
      "settings": [
        {
          "type": "text",
          "id": "title",
          "label": "Section Title",
          "default": "Shop Curated Cases"
        }
      ]
    },
    {
      "type": "product_tab",
      "name": "Product Tab",
      "limit": 6,
      "settings": [
        {
          "type": "text",
          "id": "tab_name",
          "label": "Tab Name",
          "default": "Best Selling Cases"
        },
        {
          "type": "checkbox",
          "id": "show_wine_1",
          "label": "Show Wine 1",
          "default": true
        },
        {
          "type": "text",
          "id": "wine_1_name",
          "label": "Wine 1 Name",
          "default": "Premium Red Wine Case"
        },
        {
          "type": "text",
          "id": "wine_1_vintage",
          "label": "Wine 1 Description",
          "default": "Mixed vintage selection"
        },
        {
          "type": "text",
          "id": "wine_1_price",
          "label": "Wine 1 Price",
          "default": "119.99"
        },
        {
          "type": "text",
          "id": "wine_1_button_text",
          "label": "Wine 1 Button Text",
          "default": "Add to Cart"
        },
        {
          "type": "checkbox",
          "id": "show_wine_2",
          "label": "Show Wine 2",
          "default": false
        },
        {
          "type": "text",
          "id": "wine_2_name",
          "label": "Wine 2 Name",
          "default": "White Wine Selection"
        },
        {
          "type": "text",
          "id": "wine_2_vintage",
          "label": "Wine 2 Description",
          "default": "12 bottles"
        },
        {
          "type": "text",
          "id": "wine_2_price",
          "label": "Wine 2 Price",
          "default": "89.99"
        },
        {
          "type": "text",
          "id": "wine_2_button_text",
          "label": "Wine 2 Button Text",
          "default": "Add to Cart"
        }
      ]
    },
    {
      "type": "view_all_button",
      "name": "View All Button",
      "limit": 1,
      "settings": [
        {
          "type": "text",
          "id": "button_text",
          "label": "Button Text",
          "default": "View All Cases"
        },
        {
          "type": "url",
          "id": "button_link",
          "label": "Button Link"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Curated Cases",
      "blocks": [
        {
          "type": "section_title"
        },
        {
          "type": "product_tab",
          "settings": {
            "tab_name": "Best Selling Cases"
          }
        },
        {
          "type": "view_all_button"
        }
      ]
    }
  ]
}
{% endschema %}